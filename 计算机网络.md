# 计算机网络

## IPV4与IPV6

1. 路由和寻址能力
   - IP地址从32位扩展到128位，支持更大的地址空间；
   - 采用分层分级结构，加快路由速度；
   - 增加任播，使多播不仅仅限于子网之内，可以跨子网。
2. 报头格式简化
   - 丢弃冗余的域。
3. 对可选项更大的支持
   - 可选项不放入报头，而放在一个独立的扩展头部，不指定路由器不会打开处理扩展部分。
4. 身份认证和保密
   - 加入了关于身份验证、数据一致性和保密性的内容。
5. 加强了对移动设备的支持
   - 允许移动设备在切换接入点时保留相同的IP地址。
6. 支持无状态自动配置



## 处理TIME_WAIT过多的问题

1. tcp_tw_reuse
   - 原理：选择一个上一个数据包时间错小于当前时间戳的连接复活，并忽略所有fin

2. tcp_tw_recycle
   - 原理：在TIME_WAIT过程中，放弃所有时间戳小于上一个数据包时间戳的数据包，以保证新连接的开启；
   - 缺点：无法处理NAT机制的访问（只保存ip信息，而nat多用户使用同一ip，无法与服务器正常握手）

3. 单纯增大buckets



## cookie和session的区别

1. **数据存放位置不同**：

   cookie数据存放在客户的浏览器上，session数据放在服务器上；

2. **安全程度不同**：

   cookie不是很安全，别人可以分析存放在本地的COOKIE并进行COOKIE欺骗,考虑到安全应当使用session；

3. **性能使用程度不同**：

   session会在一定时间内保存在服务器上。当访问增多，会比较占用你服务器的性能,考虑到减轻服务器性能方面，应当使用cookie。

4. **空间大小不同**：

   单个cookie保存的数据不能超过4K，很多浏览器都限制一个站点最多保存20个cookie，而session则存储与服务端，浏览器对其没有限制。

5. **会话机制不同**：

   session会话机制：

   ​	session会话机制是一种服务器端机制，它使用类似于哈希表（可能还有哈希表）的结构来	保存信息。

   cookies会话机制：

   ​	cookie是服务器存储在本地计算机上的小块文本，并随每个请求发送到同一服务器。 Web服务器使用HTTP标头将cookie发送到客户端。在客户端终端，浏览器解析cookie并将其保存为本地文件，该文件自动将来自同一服务器的任何请求绑定到这些cookie。



## 保证cookie不被劫持

1. 添加HttpOnly属性，设置后只能在http请求中传递cookie，不能再脚本中获取；
2. 增加校验位，如ip，user agent等；
3. 定时更换session id。



## HTTPS

#### 对称加密

- 机制：使用相同的秘钥进行信息传输。
- 优点：安全性高。
- 缺点：
  1. 不同的客户端、服务器数量庞大，所以双方都需要维护大量的密钥，维护成本很高；
  2. 因每个客户端、服务器的安全级别不同，密钥极易泄露。

#### 非对称加密

- 机制：客户端用公钥对请求内容加密，服务器使用私钥对内容解密。
- 优点：维护简单。
- 缺点：
  1. 公钥公开，黑客也可以截获消息；
  2. 加解密算法计算复杂度高。

#### HTTPS加密方法

1. 客户端say hello；
2. 服务端say hello，同时附带自己的SSL证书；
3. 公钥加密（采用对称加密，对称加密算法和秘钥）；
4. 私钥加密（确认应答）；
5. 对称加密（传输信息）；
6. ……

#### SSL证书

- 证书发布机构CA
- 证书有效期
- 公钥
- 证书所有者
- 签名

#### 验证SSL证书（CA）的真实性

1. 浏览器开始查找操作系统中已内置的受信任的证书发布机构CA，与服务器发来的证书中的颁发者CA比对，用于校验证书是否为合法机构颁发；
2. 从操作系统中取出CA的公钥，对服务器发送过来的CA和签名进行数字签名比对。