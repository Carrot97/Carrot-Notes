# redis

## 数据类型

1. String
2. List
3. Set
4. Hash
5. ZSet

## 持久化

为了保证数据在断电后不会丢失，需要将内存中的数据持久化到硬盘上，然后再从硬盘读取到内存。

### RDB（Redis DataBase）

redis单独创建一个子进程（Fork）来进行持久化，首先将数据写入到一个临时文件中，符合触发条件时将临时文件写入到硬盘中。

触发条件：

1. 配置文件
   - 900秒内改过一次
   - 300秒内改过10次
   - 60秒内改过10000次
2. save或bgsave
   - save阻塞保存
   - bgsave异步保存
3. flushall

- 优点

  - 适合大规模数据备份

  - 可以将快照复制到其它服务器从而创建具有相同数据的服务器副本

- 缺点

  - 如果系统发生故障，将会丢失最后一次创建快照之后的数据

  - 如果数据量很大，保存快照的时间会很长
  - Fork线程相当于热备份，消耗两倍内存

### AOF（Append Only File）

将写命令添加在AOF文件的末尾，redis启动时全部读取改文件，重构内容。

需要设置同步选项：

	1. always 每个写命令都同步
 	2. everysec 每秒都同步
 	3. no 系统决定何时同步

- 缺点

  文件大小随着服务器增多而增大



